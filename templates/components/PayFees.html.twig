<div {{ attributes }}>
    <div class="bg-white shadow sm:rounded-lg">
        <div class="px-4 py-5 sm:p-6">
            <h3 class="text-base font-semibold leading-6 text-gray-900">Teilnahmegebühren jetzt bezahlen</h3>
            <div class="mt-2 max-w-xl text-sm text-gray-500">
                <p>Bitte bedenken Sie, dass Sie die Teilnahmegebühren im Vornherein bezahlen müssen, da die Anmeldungen
                    andernfalls storniert werden.</p>
                <p class="mt-2 font-semibold">Die Frist zur Bezahlung der Teilnahmegebühren endet am XX.XX.xxxx um
                    123:32.</p>
            </div>

            {% if "address" == step %}

                {{ form_start(form, {
                    attr: {
                        'data-action': 'live#action:prevent',
                        'data-live-action-param': 'saveAddress'
                    }
                }) }}

                <div>
                    <div class="mt-6">
                        <h2 class="text-lg leading-6 font-medium text-gray-900">Rechnungsanschrift</h2>
                        <p class="mt-1 text-sm text-gray-500">Wir brauchen Ihre Anschrift zur Erstellung von Belegen für
                            die
                            Teilnahmegebühren.</p>
                    </div>

                    <div class="mt-6">

                        <div class="grid gap-6 sm:grid-cols-7">
                            <div class="sm:col-span-4">
                                {{ form_row(form.street) }}
                            </div>
                            <div class="sm:col-span-2 sm:col-start-1">
                                {{ form_row(form.postal) }}
                            </div>
                            <div class="sm:col-span-3">
                                {{ form_row(form.city) }}
                            </div>
                            <div class="sm:col-span-2">
                                {{ form_row(form.country) }}
                            </div>
                        </div>


                    </div>
                </div>

                {{ form_end(form) }}

            {% elseif "select" == step %}

                {% for participant in this.participants %}
                    {% set attendances = this.attendances|filter(a => a.participant == participant) %}

                    <fieldset class="mt-8">
                        <legend class="text-base font-semibold leading-6 text-gray-900">{{ participant.name }}</legend>
                        <div class="mt-4 divide-y divide-gray-200 border-b border-t border-gray-200">
                            {% for attendance in attendances %}
                                <div class="relative flex items-start py-4">
                                    <div class="min-w-0 flex-1 text-sm leading-6">
                                        <label for="{{ "attendance-#{attendance.id}" }}"
                                               class="select-none flex justify-between">
                                            <span class="font-semibold text-gray-900">{{ attendance.offer.name }}</span>
                                            <span class="text-gray-700">{{ (attendance.offer.fee/100)|format_currency('EUR') }}</span>
                                        </label>
                                    </div>
                                    <div class="ml-3 flex h-6 items-center">
                                        <input id="{{ "attendance-#{attendance.id}" }}"
                                               type="checkbox"
                                               data-model="selectedItems[]"
                                               value="{{ attendance.id }}"
                                               class="h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-600">
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                    </fieldset>

                {% endfor %}

                <div class="mt-5">
                    <button type="button"
                            data-action="live#emit"
                            data-live-event-param="proceedToAddress"
                            class="inline-flex items-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500">
                        {{ (this.totalAmount/100)|format_currency('EUR') }} bezahlen
                    </button>
                </div>

            {% elseif "confirm" == step %}

                <div class="">
                    <button type="button"
                            data-action="live#action"
                            data-live-action-param="redirectToPay"
                            class="inline-flex items-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500">
                        {{ (this.totalAmount/100)|format_currency('EUR') }} bezahlen
                    </button>
                </div>

                {% elseif "checkPayment" == step %}

                    <div x-data="" x-init="$nextTick(() => { $dispatch('modal:open', { url: 'https://localhost:8000/meine-anmeldungen?checkPayment=1', rounded: true, size: 'sm' }) })">
                    </div>

            {% else %}
                <div class="mt-5">
                    <button type="button"
                            data-action="live#emit"
                            data-live-event-param="proceedToSelect"
                            class="inline-flex items-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-500">
                        Teilnahmegebühren bezahlen
                    </button>
                </div>
            {% endif %}
        </div>
    </div>
</div>
